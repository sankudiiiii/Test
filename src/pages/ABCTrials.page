<apex:page standardcontroller="Opportunity" renderAs="pdf" extensions="ABCContainersInvoicesExtension" applyHtmlTag="false" showheader="false" sidebar="false" standardStylesheets="false" applyBodyTag="false">
	<head>
		<link href="{!URLFOR($Resource.ABCCSS, 'ABCContainersInvoices.css')}" rel="stylesheet"/>
		<style type="text/css" media="print">
                @page {
                    margin-bottom: 3cm;
                    @bottom-center {
                     content: element(footer);
                    }
                }
                div.footer {
                    display: block;
                    margin: 10px;
                    position: running(footer);
                }
            </style>
	</head>
		<div class="footer" name="footer">
	<p>If you have any questions about this invoice, please contact<br></br>
	{!userInstance.Name}, {!userInstance.Phone}, {!userInstance.Email}</p>
	</div>
	<apex:pageBlock >
		<apex:outputPanel id="dateBlock">
			<caption id='inv'>INVOICE</caption>
			<table id='dateTable'>		
				<tr>
					<th>Invoice Number</th>
					<th>Date</th>
				</tr>
				<tr>
					<td>#{!invoiceNo}</td>
					<td>{!invoiceDate}</td>
				</tr>
			</table>
			<caption id='comp'>{!accountInstance.Name}</caption>
			<apex:outputText value="{!accountInstance.Billingstreet}"></apex:outputText><br></br>
			<apex:outputText value="{!accountInstance.BillingCity}, {!accountInstance.BillingState}, {!accountInstance.BillingPostalCode}"></apex:outputText><br></br>
			<apex:outputText value="Phone : {!accountInstance.Phone}"></apex:outputText>
			<table id='infoTable'>
				<tr>
					<th>BILL TO</th>
				</tr>
				<tr>
					<td>{!opportunityInstance.Name}</td>
				</tr>
				<tr>
					<td>{!accountInstance.Name}</td>
				</tr>
				<tr>
					<td>{!accountInstance.BillingStreet}</td>
				</tr>
				<tr>
					<td>{!accountInstance.BillingCity}, {!accountInstance.BillingState}, {!accountInstance.BillingPostalCode}</td>
				</tr>
				<tr>
					<td>Phone : {!accountInstance.Phone}</td>
				</tr>
				<tr>
					<td>{!accountInstance.email_address__c}</td>
				</tr>
			</table>
			<table id='descTable' cellspacing="0">	
				<apex:variable var="total" value="{! 0 }" />
				<tr>
					<th>Description</th>
					<th class='rt'>Amount</th>
				</tr>
				<apex:repeat value="{!opportunityLineItemList}" var="opportunityLineItem">
				<tr>
					<td>Product : {!opportunityLineItem.Product2.Name}</td>
					<td></td>
				</tr>
				<tr>
					<td>- Unit Price</td>
					<td class='rt'>{!opportunityLineItem.UnitPrice}</td>
				</tr>
				<tr>
					<td>- Quantity </td>
					<td class='rt'>{!opportunityLineItem.Quantity}</td>
				</tr>
				<tr>
					<td>- Service Fees </td>
					<td class='rt'>
						<apex:variable var="serviceFees" value="{! (opportunityLineItem.UnitPrice * opportunityLineItem.Quantity / 100.00) * 100}" />
						<apex:outputText value="{!serviceFees}"/>
					</td>
				</tr>
				<tr>
					<td>- Discount ({!opportunityLineItem.Discount}%)</td>
					<td class='rt'>
						<apex:variable var="discount" value="{! (serviceFees * opportunityLineItem.Discount / 100 / 100.00) * 100}" />
						<apex:outputText value="{!discount}"/>
					</td>
				</tr>
				<tr>
					<td>- Opportunity Line Item Price</td>
					<td class='rt'>
						<apex:variable var="lineItemCost" value="{! ((serviceFees - discount) / 100) * 100}" />
						<apex:variable var="total" value="{! ((total + lineItemCost) / 100) * 100}" />
						<apex:outputText value="{!lineItemCost}"/>
					</td>
				</tr>
				</apex:repeat>
				<tr>
					<td class='brdr'  id="long"><i>Thank you for your business!</i></td>
					<td class='rt brdr'  id="long"><h4><apex:outputText value="Total {!total}"/></h4></td>
				</tr>
			</table>
		</apex:outputpanel>
	</apex:pageblock>
</apex:page>